<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fake News Detector — Clean UI</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-1: #0f172a; /* deep navy */
      --card: #0b1220;
      --muted: #94a3b8;
      --accent: linear-gradient(90deg,#7c3aed,#06b6d4);
      --glass: rgba(255,255,255,0.04);
      --success: #16a34a;
      --danger: #ef4444;
      --glass-border: rgba(255,255,255,0.06);
      --radius: 14px;
      color-scheme: dark;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      min-height:100vh;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(124,58,237,0.12), transparent 6%),
                  radial-gradient(1000px 500px at 90% 90%, rgba(6,182,212,0.08), transparent 6%),
                  var(--bg-1);
      display:flex;align-items:center;justify-content:center;padding:28px;color:#e6eef8;
    }

    .app{
      width:100%;max-width:1100px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid var(--glass-border);border-radius:18px;padding:22px;display:grid;grid-template-columns:1fr 380px;gap:22px;backdrop-filter: blur(6px);
      box-shadow: 0 10px 40px rgba(2,6,23,0.6);
    }

    header.app-header{grid-column:1/-1;display:flex;align-items:center;gap:16px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:56px;height:56px;border-radius:12px;display:grid;place-items:center;background:var(--glass);border:1px solid var(--glass-border)}
    .logo svg{width:34px;height:34px}
    h1{font-size:20px;margin:0;font-weight:700}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    /* left column */
    .main{
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      padding:18px;border-radius:12px;border:1px solid var(--glass-border);
      display:flex;flex-direction:column;gap:14px;min-height:420px;
    }

    label.small{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    textarea#newsText{
      width:100%;min-height:220px;padding:14px;background:transparent;border:1px dashed var(--glass-border);border-radius:10px;color:inherit;font-size:15px;resize:vertical;
      transition:box-shadow .18s, border-color .18s;line-height:1.45
    }
    textarea#newsText:focus{outline:none;border:1px solid rgba(124,58,237,0.6);box-shadow:0 6px 30px rgba(124,58,237,0.08)}

    .controls{display:flex;gap:10px;align-items:center}
    .btn{cursor:pointer;padding:10px 14px;border-radius:10px;border:1px solid transparent;font-weight:600;font-size:14px}
    .btn-primary{background:var(--accent);color:#061024;box-shadow:0 6px 20px rgba(7,15,29,0.5);border:1px solid rgba(255,255,255,0.03)}
    .btn-ghost{background:transparent;border:1px solid var(--glass-border);color:var(--muted)}
    .btn:disabled{opacity:.5;cursor:not-allowed}

    .examples{display:flex;gap:8px;flex-wrap:wrap}
    .chip{background:var(--glass);padding:8px 10px;border-radius:999px;border:1px solid var(--glass-border);font-size:13px;color:var(--muted);cursor:pointer}

    .meta{display:flex;gap:10px;align-items:center;color:var(--muted);font-size:13px}

    /* right column */
    .sidebar{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:18px;border-radius:12px;border:1px solid var(--glass-border);min-height:420px;display:flex;flex-direction:column;gap:12px}

    .result-card{padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border:1px solid var(--glass-border);display:flex;flex-direction:column;gap:10px}
    .result-label{display:flex;align-items:center;gap:10px}
    .badge{padding:6px 10px;border-radius:999px;font-weight:700;font-size:13px}
    .badge.real{background:linear-gradient(90deg,#34d399,#10b981);color:#062018}
    .badge.fake{background:linear-gradient(90deg,#fb7185,#ef4444);color:#23060a}

    .confidence{display:flex;flex-direction:column;gap:8px}
    .bar{height:18px;background:rgba(255,255,255,0.04);border-radius:999px;overflow:hidden;border:1px solid var(--glass-border)}
    .bar > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,#60a5fa,#7c3aed);transition:width 900ms cubic-bezier(.2,.9,.2,1)}
    .conf-text{font-weight:700;color:var(--muted);font-size:13px}

    .explain{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;font-size:13px;color:var(--muted);border:1px solid var(--glass-border)}

    .history{display:flex;flex-direction:column;gap:8px;overflow:auto;max-height:180px;padding-right:6px}
    .history .item{display:flex;justify-content:space-between;gap:8px;padding:8px;border-radius:8px;background:transparent;border:1px dashed rgba(255,255,255,0.02);font-size:13px}
    .history .item .meta{color:var(--muted);font-size:12px}

    footer.hint{grid-column:1/-1;color:var(--muted);font-size:13px;margin-top:6px}

    /* Responsive */
    @media (max-width:980px){
      .app{grid-template-columns:1fr;}
      .sidebar{order:2}
    }

  </style>
</head>
<body>
  <main class="app" role="main" aria-labelledby="appTitle">
    <header class="app-header">
      <div class="brand">
        <div class="logo" aria-hidden>
          <!-- simple magnifier/news logo -->
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden>
            <path d="M11 4a7 7 0 100 14 7 7 0 000-14z" stroke="#e6eef8" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M21 21l-4.35-4.35" stroke="#a5b4fc" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div>
          <h1 id="appTitle">Fake News Detector</h1>
          <p class="lead">Fast, explainable predictions — paste text or try the examples.</p>
        </div>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <div class="meta">Model: <strong style="color:#fff;margin-left:6px">TF-IDF + LR (demo)</strong></div>
      </div>
    </header>

    <section class="main" aria-label="input area">
      <div>
        <label for="newsText" class="small">Article / Headline</label>
        <textarea id="newsText" inputmode="text" placeholder="Paste an article, headline, or a social post. (Tip: press Ctrl+Enter to analyze)"></textarea>
      </div>

      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
        <div class="controls">
          <button class="btn btn-primary" id="analyzeBtn" aria-label="Analyze news">Analyze</button>
          <button class="btn btn-ghost" id="clearBtn" aria-label="Clear input">Clear</button>
          <button class="btn btn-ghost" id="exampleToggle" aria-pressed="false" title="Insert an example">Examples</button>
        </div>

        <div style="text-align:right">
          <div class="meta">Response time: <strong id="respTime">—</strong></div>
        </div>
      </div>

      <div style="display:flex;gap:10px;align-items:center;margin-top:6px">
        <div class="examples" id="examples">
          <button class="chip" data-sample="WHO Approves New Malaria Vaccine...\nThe World Health Organization (WHO) has approved...">vaccine (real)</button>
          <button class="chip" data-sample="Scientists Confirm the Earth Will Stop Spinning Next Week...\nA viral post claims the Earth will stop spinning next week...">earth stop (fake)</button>
          <button class="chip" data-sample="Nigerian Government to Give Every Citizen...\nA viral Facebook post claims that the government will distribute...">govt money (fake)</button>
          <button class="chip" data-sample="NASA Confirms Successful Launch of Artemis II Mission...\nNASA has successfully launched the Artemis II mission...">space (real)</button>
        </div>
      </div>

      <div style="margin-top:auto;display:flex;gap:8px;align-items:center;justify-content:space-between">
        <div class="meta">Tip: Use Ctrl+Enter to run quickly</div>
        <div class="meta">Confidence shown as %</div>
      </div>
    </section>

    <aside class="sidebar" aria-label="results and history">
      <div class="result-card" aria-live="polite">
        <div class="result-label">
          <div id="badgeWrap"><span class="badge" id="resultBadge">—</span></div>
          <div style="flex:1">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:700">Prediction</div>
              <div style="font-size:13px;color:var(--muted)" id="predictedText">—</div>
            </div>
            <div class="conf-text" id="detailText">Model confidence and short explanation</div>
          </div>
        </div>

        <div class="confidence">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-size:13px;color:var(--muted)">Confidence</div>
            <div style="font-size:13px;color:var(--muted)" id="confPct">—%</div>
          </div>
          <div class="bar" aria-hidden><i id="confBar"></i></div>
        </div>

        <div class="explain" id="explain">Model highlight: top contributing words will appear here.</div>
      </div>

      <div style="flex:1;display:flex;flex-direction:column;gap:8px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700">History</div>
          <button class="btn btn-ghost" id="clearHistory">Clear</button>
        </div>

        <div class="history" id="history" role="list"></div>
      </div>

    </aside>

 </main>

  <script>
    // UI behaviour + lightweight client-side demo fallback
    const newsText = document.getElementById('newsText');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const clearBtn = document.getElementById('clearBtn');
    const examplesWrap = document.getElementById('examples');
    const respTime = document.getElementById('respTime');

    const badge = document.getElementById('resultBadge');
    const predictedText = document.getElementById('predictedText');
    const detailText = document.getElementById('detailText');
    const confPct = document.getElementById('confPct');
    const confBar = document.getElementById('confBar');
    const explain = document.getElementById('explain');
    const historyEl = document.getElementById('history');
    const clearHistoryBtn = document.getElementById('clearHistory');

    // hook up chips
    examplesWrap.addEventListener('click', e => {
      const el = e.target.closest('[data-sample]');
      if(!el) return;
      newsText.value = el.dataset.sample;
      newsText.focus();
    });

    // keyboard shortcut
    newsText.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
        analyze();
      }
    });

    analyzeBtn.addEventListener('click', analyze);
    clearBtn.addEventListener('click', () => { newsText.value = ''; newsText.focus(); });
    clearHistoryBtn.addEventListener('click', () => { historyEl.innerHTML = ''; });

    async function analyze() {
      const text = newsText.value.trim();
      if(!text) { alert('Please paste or type some text to analyze'); newsText.focus(); return; }

      analyzeBtn.disabled = true; analyzeBtn.textContent = 'Analyzing...';
      const t0 = performance.now();

      // Try to call backend; if not available, run a tiny client-side heuristic for demo
      try {
        const res = await fetch('/predict', {
          method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({text})
        });

        if(!res.ok) throw new Error('Server returned ' + res.status);
        const data = await res.json();
        if(!data || !data.success) throw new Error(data?.error || 'Invalid response');
        showResult(data.prediction, data.is_fake, data.confidence, data.explanation || '—');
      } catch(err) {
        // offline fallback: tiny heuristic + randomness for demo only
        const fallback = clientFallback(text);
        showResult(fallback.prediction, fallback.is_fake, fallback.confidence, fallback.explanation);
      } finally {
        const t1 = performance.now();
        respTime.textContent = Math.round(t1 - t0) + 'ms';
        analyzeBtn.disabled = false; analyzeBtn.textContent = 'Analyze';
      }
    }

    function clientFallback(text){
      // toy heuristic: if text contains many strong emotive words and exclamation marks => likely fake
      const fakeSignals = ['shocking','confirmed','cure','never','will stop','miracle','urgent','scam','giveaway','won','secret'];
      let score = 0;
      const txt = text.toLowerCase();
      fakeSignals.forEach(w => { if(txt.includes(w)) score += 1; });
      score += (txt.match(/!/g)||[]).length * 0.6;

      const confidence = Math.min(95, 30 + score * 20 + Math.random()*30);
      const is_fake = confidence > 55;
      return { prediction: is_fake? 'FAKE':'REAL', is_fake, confidence: confidence.toFixed(1), explanation: is_fake? 'Detected emotional language, strong claims':'Language appears informational and neutral' };
    }

    function showResult(prediction, is_fake, confidence, explanation){
      const conf = Number(confidence);
      badge.className = 'badge ' + (is_fake? 'fake':'real');
      badge.textContent = is_fake? 'FAKE':'REAL';
      predictedText.textContent = prediction;
      detailText.textContent = is_fake? 'Flagged as likely misinformation':'Likely authentic';
      confPct.textContent = Math.round(conf) + '%';
      confBar.style.width = Math.max(2, Math.min(100, Math.round(conf))) + '%';
      explain.textContent = explanation;

      // push to history
      const item = document.createElement('div'); item.className='item';
      item.innerHTML = `<div style="flex:1;min-width:0"><strong style="display:block">${prediction}</strong><div class="meta">${explanation}</div></div><div style="min-width:80px;text-align:right" class="meta">${Math.round(conf)}%</div>`;
      historyEl.prepend(item);
    }

  </script>
</body>
</html>
